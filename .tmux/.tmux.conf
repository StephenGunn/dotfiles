# ============================================================================
# TMUX SESSION MANAGEMENT CONFIG
# ============================================================================
# Goal: Simple, persistent session management for neovim and AI agents
# No splits/panes needed - just named sessions that survive reboots
# ============================================================================

# ----------------------------------------------------------------------------
# Basic Settings
# ----------------------------------------------------------------------------
set -g prefix C-b                      # Prefix key (Ctrl-b)
set -g mouse on                        # Enable mouse support
set -g base-index 1                    # Start window numbering at 1
set -g renumber-windows on             # Re-number windows when one closes
set -g status-position top             # Status bar at top

# ----------------------------------------------------------------------------
# Vi Mode
# ----------------------------------------------------------------------------
set-option -g mode-keys vi             # Vi-style key bindings

# ----------------------------------------------------------------------------
# Terminal & Colors (for neovim compatibility)
# ----------------------------------------------------------------------------
set-option -sg escape-time 10                    # Faster escape time
set-option -g default-terminal "tmux-256color"   # 256 color support
set -ag terminal-overrides ",$TERM:Tc"           # True color support
set-option -g focus-events on                    # Focus events for neovim

# ----------------------------------------------------------------------------
# Key Bindings
# ----------------------------------------------------------------------------
unbind-key r
bind-key r source-file ~/.tmux.conf \; display "✓ Config reloaded!"

# ----------------------------------------------------------------------------
# Plugins
# ----------------------------------------------------------------------------
set -g @plugin 'tmux-plugins/tpm'                # Plugin manager
set -g @plugin 'tmux-plugins/tmux-resurrect'    # Save/restore sessions
set -g @plugin 'tmux-plugins/tmux-continuum'    # Auto-save resurrect
set -g @plugin 'omerxx/tmux-sessionx'           # Fuzzy session picker

# ----------------------------------------------------------------------------
# Plugin Configuration
# ----------------------------------------------------------------------------

# Resurrect - what to save/restore
set -g @resurrect-capture-pane-contents 'on'    # Save pane contents
set -g @resurrect-strategy-nvim 'session'       # Restore neovim sessions

# Continuum - auto-save every 15 minutes
set -g @continuum-restore 'on'                  # Auto-restore on tmux start
set -g @continuum-save-interval '15'            # Save every 15 minutes

# Sessionx - fuzzy session picker
set -g @sessionx-bind 's'                       # Ctrl-b s to open session picker
set -g @sessionx-filter-current 'false'         # Show current session in list
set -g @sessionx-preview-enabled 'true'         # Show preview of sessions

# ----------------------------------------------------------------------------
# ----------------------------------------------------------------------------
# ----------------------------------------------------------------------------
# ----------------------------------------------------------------------------
# ----------------------------------------------------------------------------
# Status Bar Styling (minimal, clean)
# ----------------------------------------------------------------------------
# Auto-generated by theme-switcher - colors from current theme

# Status bar appearance (dark bg, subtle fg)
set -g status-style "bg=#1d2021,fg=#a89984"
set -g status-justify left
set -g status-left-length 40
set -g status-right-length 80

# Left: session name with icon (prominent accent)
set -g status-left "#[fg=#d79921,bold]  #S #[fg=#504945]│ "

# Window list
set -g window-status-format "#[fg=#665c54]#I #[fg=#7c6f64]#W  "
set -g window-status-current-format "#[fg=#fabd2f,bold]#I #[fg=#ebdbb2]#W  "
set -g window-status-separator ""

# Right: minimal date/time
set -g status-right "#[fg=#504945]│ #[fg=#928374]%H:%M #[fg=#665c54]%Y-%m-%d"

# Initialize TPM (keep this at the very bottom)
# ============================================================================
run '~/.tmux/plugins/tpm/tpm'
